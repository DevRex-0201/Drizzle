## Views (WIP)

> **Warning**: views are currently only implemented on the ORM side. That means you can query the views that already exist in the database, but they won't be added to drizzle-kit migrations or `db push` yet.

### Creating a view

```ts copy
import { mysqlView } from 'drizzle-orm/mysql-core';
const newYorkers = mysqlView('new_yorkers').as((qb) => qb.select().from(users).where(eq(users.cityId, 1)));
```

#### Full view definition syntax

```ts copy
const newYorkers = mysqlView('new_yorkers')
  .algorithm('merge')
  .definer('root@localhost')
  .sqlSecurity('definer')
  .as((qb) => {
    const sq = qb
      .$with('sq')
      .as(
        qb.select({ userId: users.id, cityId: cities.id })
          .from(users)
          .leftJoin(cities, eq(cities.id, users.homeCity))
          .where(sql`${users.age1} > 18`),
      );
    return qb.with(sq).select().from(sq).where(sql`${users.homeCity} = 1`);
  });
```

> **Warning**: All the parameters inside the query will be inlined, instead of replaced by `$1`, `$2`, etc.
You can also use the [`queryBuilder` instance](./query-builder) directly instead of passing a callback, if you already have it imported.

```ts copy
import { queryBuilder as qb } from 'drizzle-orm/mysql-core';
const newYorkers = mysqlView('new_yorkers').as(qb.select().from(users2Table).where(eq(users2Table.cityId, 1)));
```

### Using raw SQL in a view query

In case you need to specify the view query using a syntax that is not supported by the query builder, you can directly use SQL. In that case, you also need to specify the view shape.

```ts copy
const newYorkers = mysqlView('new_yorkers', {
  id: serial('id').primaryKey(),
  name: text('name').notNull(),
  cityId: integer('city_id').notNull(),
}).as(sql`select * from ${users} where ${eq(users.cityId, 1)}`);
```

### Describing existing views

There are cases when you are given readonly access to an existing view. In such cases you can just describe the view shape without specifying the query itself or using it in the migrations.

```ts copy
const newYorkers = mysqlView('new_yorkers', {
  userId: integer('user_id').notNull(),
  cityId: integer('city_id'),
}).existing();
```